import{W as O,y as T,A as h,H,I as K,s as W,B as z}from"./element-plus.33d6376e.js";import{M as G}from"./picker.81797079.js";import{P as J}from"./index.f737ad24.js";import{r as p,f as Q}from"./index.b4774df2.js";import{u as X}from"./useDictOptions.d5fac862.js";import{r as Y}from"./role.a1b4d7dc.js";import{d as Z}from"./post.d530cafd.js";import{d as ee}from"./department.443da88e.js";import{d as ue,s as y,r as le,e as k,$ as A,o as i,c as V,U as a,L as t,u as n,a as E,V as I,a8 as U,K as f,R as x}from"./@vue.230e89ba.js";function be(s){return p.get({url:"/system/admin/list",params:s})}function ae(s){return p.post({url:"/system/admin/add",params:s})}function oe(s){return p.get({url:"/system/admin/detail",params:s})}function te(s){return p.post({url:"/system/admin/edit",params:s})}function _e(s){return p.post({url:"/system/admin/del",params:s})}function Ce(s){return p.post({url:"/system/admin/disable",params:s})}const se={class:"edit-popup"},re=E("div",{class:"form-tips"},"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A100*100px\uFF0C\u652F\u6301jpg\uFF0Cjpeg\uFF0Cpng\u683C\u5F0F",-1),Ve=ue({__name:"edit",emits:["success","close"],setup(s,{expose:R,emit:v}){const w=y(),F=y(),c=le("add"),S=k(()=>c.value=="edit"?"\u7F16\u8F91\u7BA1\u7406\u5458":"\u65B0\u589E\u7BA1\u7406\u5458"),u=A({id:"",username:"",nickname:"",deptId:"",postId:"",role:"",avatar:"",password:"",passwordConfirm:"",isDisable:0,isMultipoint:1}),m=k(()=>u.role=="0"),B=A({username:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:["blur"]}],nickname:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}],role:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",trigger:["blur"]}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur",pattern:/(^[^\s]*$)/},{validator:(d,e,o)=>{e?o():o(new Error("\u8BF7\u8F93\u5165\u5BC6\u7801"))},trigger:"blur"}],passwordConfirm:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",trigger:"blur",pattern:/(^[^\s]*$)/},{validator:(d,e,o)=>{u.password&&(e||o(new Error("\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801")),e!==u.password&&o(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))),o()},trigger:"blur"}]}),{optionsData:b}=X({role:{api:Y},post:{api:Z},dept:{api:ee}}),q=async()=>{var d,e;await((d=w.value)==null?void 0:d.validate()),c.value=="edit"?await te(u):await ae(u),(e=F.value)==null||e.close(),Q.msgSuccess("\u64CD\u4F5C\u6210\u529F"),v("success")},M=(d="add")=>{var e;c.value=d,(e=F.value)==null||e.open()},N=async d=>{const e=await oe({id:d.id});for(const o in u)e[o]!=null&&e[o]!=null&&(u[o]=e[o]),Number(u.deptId)==0&&(u.deptId=""),Number(u.postId)==0&&(u.postId="");B.password=[],B.passwordConfirm=[]},L=()=>{v("close")};return R({open:M,setFormData:N}),(d,e)=>{const o=T,r=h,P=G,$=O,_=H,g=K,D=W,j=z;return i(),V("div",se,[a(J,{ref_key:"popupRef",ref:F,title:n(S),async:!0,width:"550px",clickModalClose:!0,onConfirm:q,onClose:L},{default:t(()=>[a(j,{ref_key:"formRef",ref:w,model:u,"label-width":"84px",rules:B},{default:t(()=>[a(r,{label:"\u8D26\u53F7",prop:"username"},{default:t(()=>[a(o,{modelValue:u.username,"onUpdate:modelValue":e[0]||(e[0]=l=>u.username=l),disabled:n(m),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7"},null,8,["modelValue","disabled"])]),_:1}),a(r,{label:"\u5934\u50CF"},{default:t(()=>[E("div",null,[E("div",null,[a(P,{modelValue:u.avatar,"onUpdate:modelValue":e[1]||(e[1]=l=>u.avatar=l),limit:1},null,8,["modelValue"])]),re])]),_:1}),a(r,{label:"\u540D\u79F0",prop:"nickname"},{default:t(()=>[a(o,{modelValue:u.nickname,"onUpdate:modelValue":e[2]||(e[2]=l=>u.nickname=l),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptId"},{default:t(()=>[a($,{class:"flex-1",modelValue:u.deptId,"onUpdate:modelValue":e[3]||(e[3]=l=>u.deptId=l),data:n(b).dept,clearable:"","node-key":"id",props:{value:"id",label:"name",disabled(l){return l.isStop}},"check-strictly":"","default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1}),a(r,{label:"\u5C97\u4F4D",prop:"deptId"},{default:t(()=>[a(g,{class:"flex-1",modelValue:u.postId,"onUpdate:modelValue":e[4]||(e[4]=l=>u.postId=l),placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D"},{default:t(()=>[(i(!0),V(I,null,U(n(b).post,(l,C)=>(i(),f(_,{key:C,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u89D2\u8272",prop:"role"},{default:t(()=>[a(g,{modelValue:u.role,"onUpdate:modelValue":e[5]||(e[5]=l=>u.role=l),disabled:n(m),class:"flex-1",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:t(()=>[n(m)?(i(),f(_,{key:0,label:"\u7CFB\u7EDF\u7BA1\u7406\u5458",value:"0"})):x("",!0),(i(!0),V(I,null,U(n(b).role,(l,C)=>(i(),f(_,{key:C,label:l.name,value:String(l.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(r,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[a(o,{modelValue:u.password,"onUpdate:modelValue":e[6]||(e[6]=l=>u.password=l),"show-password":"",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u786E\u8BA4\u5BC6\u7801",prop:"passwordConfirm"},{default:t(()=>[a(o,{modelValue:u.passwordConfirm,"onUpdate:modelValue":e[7]||(e[7]=l=>u.passwordConfirm=l),"show-password":"",placeholder:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),n(m)?x("",!0):(i(),f(r,{key:0,label:"\u7BA1\u7406\u5458\u72B6\u6001"},{default:t(()=>[a(D,{modelValue:u.isDisable,"onUpdate:modelValue":e[8]||(e[8]=l=>u.isDisable=l),"active-value":0,"inactive-value":1},null,8,["modelValue"])]),_:1})),a(r,{label:"\u591A\u5904\u767B\u5F55"},{default:t(()=>[a(D,{modelValue:u.isMultipoint,"onUpdate:modelValue":e[9]||(e[9]=l=>u.isMultipoint=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])])}}});export{Ve as _,Ce as a,_e as b,be as c};
