import{X as J,C as W,w as Y,E as Z,a as ee,O as ue,P as le,_ as oe,$ as te,D as se,v as ae,F as ne}from"./element-plus.151049e5.js";import{n as de,o as ie,b as re,p as me,M as p,q as pe,t as ce,f as Fe}from"./index.0fa067ce.js";import{d as P,r as g,s as I,a0 as z,e as G,w as _e,j as fe,o as i,c as D,V as l,M as o,u as r,L as f,W as O,a as s,a8 as L,Q as Ee,U as ve,_ as R,T as E,n as q,S as v}from"./@vue.cab01781.js";import{c as Ce}from"./@vueuse.724ed0af.js";import{m as be,a as Ve,b as Be,c as De}from"./menu.6f107312.js";import{P as he}from"./index.f9f63a04.js";const ye={class:"icon-select"},Ae={class:"flex justify-between"},Te=s("div",{class:"mb-3"},"\u8BF7\u9009\u62E9\u56FE\u6807",-1),ke=["onClick"],ge={class:"h-[280px]"},Ue={class:"flex flex-wrap"},we={key:0,class:"flex items-center"},Ne=E("\u65E0"),xe=P({__name:"picker",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(h,{emit:y}){const A=g(0),T=[{name:"element\u56FE\u6807",icons:de()},{name:"\u672C\u5730\u56FE\u6807",icons:ie()}],C=I(),a=z({inputValue:"",popoverVisible:!1,popoverWidth:0,mouseoverSelect:!1,inputFocus:!1}),N=()=>{a.inputFocus=a.popoverVisible=!0},U=()=>{a.inputFocus=!1,a.popoverVisible=a.mouseoverSelect},x=c=>{a.mouseoverSelect=a.popoverVisible=!1,y("update:modelValue",c),y("change",c)},u=()=>{y("update:modelValue",""),y("change","")},S=G(()=>{var _,V;const c=(V=(_=T[A.value])==null?void 0:_.icons)!=null?V:[];if(!a.inputValue)return c;const d=a.inputValue.toLowerCase();return c.filter(B=>{if(B.toLowerCase().indexOf(d)!==-1)return B})}),w=()=>{q(()=>{var d;const c=(d=C.value)==null?void 0:d.$el.offsetWidth;a.popoverWidth=c<300?300:c})};return Ce(document.body,"click",()=>{a.popoverVisible=!!(a.inputFocus||a.mouseoverSelect)}),_e(()=>a.popoverVisible,async c=>{var d,_;await q(),c?(d=C.value)==null||d.focus():(_=C.value)==null||_.blur()}),fe(()=>{w()}),(c,d)=>{const _=re,V=Y,B=Z,M=ee,$=J;return i(),D("div",ye,[l($,{trigger:"contextmenu",visible:a.popoverVisible,"onUpdate:visible":d[3]||(d[3]=t=>a.popoverVisible=t),width:a.popoverWidth},{reference:o(()=>[l(r(W),{ref_key:"inputRef",ref:C,modelValue:a.inputValue,"onUpdate:modelValue":d[2]||(d[2]=t=>a.inputValue=t),modelModifiers:{trim:!0},placeholder:"\u641C\u7D22\u56FE\u6807",autofocus:!1,disabled:h.disabled,onFocus:N,onBlur:U,clearable:""},{prepend:o(()=>[h.modelValue?(i(),D("div",we,[l(M,{class:"flex-1 w-20",content:h.modelValue,placement:"top"},{default:o(()=>[(i(),f(_,{class:"mr-1",key:h.modelValue,name:h.modelValue,size:16},null,8,["name"]))]),_:1},8,["content"])])):(i(),D(O,{key:1},[Ne],64))]),append:o(()=>[l(V,null,{default:o(()=>[l(_,{name:"el-icon-Close",size:18,onClick:u})]),_:1})]),_:1},8,["modelValue","disabled"])]),default:o(()=>[s("div",{onMouseover:d[0]||(d[0]=R(t=>a.mouseoverSelect=!0,["stop"])),onMouseout:d[1]||(d[1]=R(t=>a.mouseoverSelect=!1,["stop"]))},[s("div",null,[s("div",Ae,[Te,s("div",null,[(i(),D(O,null,L(T,(t,e)=>s("span",{key:e,class:Ee(["cursor-pointer text-sm ml-2",{"text-primary":e==A.value}]),onClick:m=>A.value=e},ve(t.name),11,ke)),64))])]),s("div",ge,[l(B,null,{default:o(()=>[s("div",Ue,[(i(!0),D(O,null,L(r(S),t=>(i(),D("div",{key:t,class:"m-1"},[l(V,{onClick:e=>x(t)},{default:o(()=>[l(_,{name:t,size:18},null,8,["name"])]),_:2},1032,["onClick"])]))),128))])]),_:1})])])],32)]),_:1},8,["visible","width"])])}}}),Se={class:"edit-popup"},Me=E("\u76EE\u5F55"),$e=E("\u83DC\u5355"),Oe=E("\u6309\u94AE"),Ie={class:"flex-1"},Le=s("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`admin`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934 ",-1),Re={class:"flex-1"},qe=s("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`permission/admin/index`\uFF0C\u9ED8\u8BA4\u5728`views`\u76EE\u5F55\u4E0B ",-1),We={class:"flex-1"},Pe=s("div",{class:"form-tips"}," \u8BBF\u95EE\u8BE6\u60C5\u9875\u9762\uFF0C\u7F16\u8F91\u9875\u9762\u65F6\uFF0C\u83DC\u5355\u9AD8\u4EAE\u663E\u793A\uFF0C\u5982`/consumer/lists` ",-1),ze={class:"flex-1"},Ge=s("div",{class:"form-tips"}," \u5C06\u4F5C\u4E3Aserver\u7AEFAPI\u9A8C\u6743\u4F7F\u7528\uFF0C\u5982`system:admin:list`\uFF0C\u8BF7\u8C28\u614E\u4FEE\u6539 ",-1),je={class:"flex-1"},Ke=s("div",{class:"form-tips"},' \u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A`{"id": 1, "name": "admin"}`\u6216`id=1&name=admin` ',-1),Qe=E("\u7F13\u5B58"),Xe=E("\u4E0D\u7F13\u5B58"),He=s("div",{class:"form-tips"},"\u9009\u62E9\u7F13\u5B58\u5219\u4F1A\u88AB`keep-alive`\u7F13\u5B58",-1),Je=E("\u663E\u793A"),Ye=E("\u9690\u85CF"),Ze=s("div",{class:"form-tips"}," \u9009\u62E9\u9690\u85CF\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE ",-1),eu=E("\u6B63\u5E38"),uu=E("\u505C\u7528"),lu=s("div",{class:"form-tips"},"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",-1),ou=s("div",{class:"form-tips"},"\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),ru=P({__name:"edit",emits:["success","close"],setup(h,{expose:y,emit:A}){const T=I(),C=I(),a=g("add"),N=G(()=>a.value=="edit"?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),U=g(me()),x=(t,e)=>{const m=t?U.value.filter(b=>b.toLowerCase().includes(t.toLowerCase())):U.value;e(m.map(b=>({value:b})))},u=z({id:"",pid:0,menuType:p.CATALOGUE,menuIcon:"",menuName:"",menuSort:0,paths:"",perms:"",component:"",selected:"",params:"",isCache:1,isShow:1,isDisable:0}),S={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",trigger:["blur","change"]}],menuName:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"}],paths:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740",trigger:"blur"}],component:[{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"}]},w=g([]),c=g([]),d=async()=>{const t=await be(),e={id:0,menuName:"\u9876\u7EA7",children:[]};c.value=pe(ce(t).filter(m=>m.menuType!=p.BUTTON)),e.children=t,w.value.push(e)},_=async()=>{var t,e;await((t=T.value)==null?void 0:t.validate()),a.value=="edit"?await Ve(u):await Be(u),(e=C.value)==null||e.close(),Fe.msgSuccess("\u64CD\u4F5C\u6210\u529F"),A("success")},V=(t="add")=>{var e;a.value=t,(e=C.value)==null||e.open()},B=t=>{for(const e in u)t[e]!=null&&t[e]!=null&&(u[e]=t[e])},M=async t=>{const e=await De({id:t.id});B(e)},$=()=>{A("close")};return d(),y({open:V,setFormData:B,getDetail:M}),(t,e)=>{const m=ue,b=le,F=se,j=oe,k=W,K=xe,Q=te,X=ae,H=ne;return i(),D("div",Se,[l(he,{ref_key:"popupRef",ref:C,title:r(N),async:!0,width:"550px",onConfirm:_,onClose:$},{default:o(()=>[l(H,{ref_key:"formRef",ref:T,model:u,"label-width":"80px",rules:S},{default:o(()=>[l(F,{label:"\u83DC\u5355\u7C7B\u578B",prop:"menuType",required:""},{default:o(()=>[l(b,{modelValue:u.menuType,"onUpdate:modelValue":e[0]||(e[0]=n=>u.menuType=n)},{default:o(()=>[l(m,{label:r(p).CATALOGUE},{default:o(()=>[Me]),_:1},8,["label"]),l(m,{label:r(p).MENU},{default:o(()=>[$e]),_:1},8,["label"]),l(m,{label:r(p).BUTTON},{default:o(()=>[Oe]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(F,{label:"\u7236\u7EA7\u83DC\u5355",prop:"pid"},{default:o(()=>[l(j,{class:"flex-1",modelValue:u.pid,"onUpdate:modelValue":e[1]||(e[1]=n=>u.pid=n),data:w.value,clearable:"","node-key":"id",props:{label:"menuName"},"default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355","check-strictly":""},null,8,["modelValue","data"])]),_:1}),l(F,{label:"\u83DC\u5355\u540D\u79F0",prop:"menuName"},{default:o(()=>[l(k,{modelValue:u.menuName,"onUpdate:modelValue":e[2]||(e[2]=n=>u.menuName=n),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u.menuType!=r(p).BUTTON?(i(),f(F,{key:0,label:"\u83DC\u5355\u56FE\u6807",prop:"menuIcon"},{default:o(()=>[l(K,{class:"flex-1",modelValue:u.menuIcon,"onUpdate:modelValue":e[3]||(e[3]=n=>u.menuIcon=n)},null,8,["modelValue"])]),_:1})):v("",!0),u.menuType!=r(p).BUTTON?(i(),f(F,{key:1,label:"\u8DEF\u7531\u8DEF\u5F84",prop:"paths"},{default:o(()=>[s("div",Ie,[l(k,{modelValue:u.paths,"onUpdate:modelValue":e[4]||(e[4]=n=>u.paths=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Le])]),_:1})):v("",!0),u.menuType==r(p).MENU?(i(),f(F,{key:2,label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:o(()=>[s("div",Re,[l(Q,{class:"w-full",modelValue:u.component,"onUpdate:modelValue":e[5]||(e[5]=n=>u.component=n),"fetch-suggestions":x,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"]),qe])]),_:1})):v("",!0),u.menuType==r(p).MENU?(i(),f(F,{key:3,label:"\u9009\u4E2D\u83DC\u5355",prop:"p"},{default:o(()=>[s("div",We,[l(k,{modelValue:u.selected,"onUpdate:modelValue":e[6]||(e[6]=n=>u.selected=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Pe])]),_:1})):v("",!0),u.menuType!=r(p).CATALOGUE?(i(),f(F,{key:4,label:"\u6743\u9650\u5B57\u7B26",prop:"perms"},{default:o(()=>[s("div",ze,[l(k,{modelValue:u.perms,"onUpdate:modelValue":e[7]||(e[7]=n=>u.perms=n),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:""},null,8,["modelValue"]),Ge])]),_:1})):v("",!0),u.menuType==r(p).MENU?(i(),f(F,{key:5,label:"\u8DEF\u7531\u53C2\u6570",prop:"params"},{default:o(()=>[s("div",null,[s("div",je,[l(k,{modelValue:u.params,"onUpdate:modelValue":e[8]||(e[8]=n=>u.params=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u53C2\u6570",clearable:""},null,8,["modelValue"])]),Ke])]),_:1})):v("",!0),u.menuType==r(p).MENU?(i(),f(F,{key:6,label:"\u662F\u5426\u7F13\u5B58",prop:"isCache",required:""},{default:o(()=>[s("div",null,[l(b,{modelValue:u.isCache,"onUpdate:modelValue":e[9]||(e[9]=n=>u.isCache=n)},{default:o(()=>[l(m,{label:1},{default:o(()=>[Qe]),_:1}),l(m,{label:0},{default:o(()=>[Xe]),_:1})]),_:1},8,["modelValue"]),He])]),_:1})):v("",!0),u.menuType!=r(p).BUTTON?(i(),f(F,{key:7,label:"\u662F\u5426\u663E\u793A",prop:"isShow",required:""},{default:o(()=>[s("div",null,[l(b,{modelValue:u.isShow,"onUpdate:modelValue":e[10]||(e[10]=n=>u.isShow=n)},{default:o(()=>[l(m,{label:1},{default:o(()=>[Je]),_:1}),l(m,{label:0},{default:o(()=>[Ye]),_:1})]),_:1},8,["modelValue"]),Ze])]),_:1})):v("",!0),u.menuType!=r(p).BUTTON?(i(),f(F,{key:8,label:"\u83DC\u5355\u72B6\u6001",prop:"isDisable",required:""},{default:o(()=>[s("div",null,[l(b,{modelValue:u.isDisable,"onUpdate:modelValue":e[11]||(e[11]=n=>u.isDisable=n)},{default:o(()=>[l(m,{label:0},{default:o(()=>[eu]),_:1}),l(m,{label:1},{default:o(()=>[uu]),_:1})]),_:1},8,["modelValue"]),lu])]),_:1})):v("",!0),l(F,{label:"\u83DC\u5355\u6392\u5E8F",prop:"menuSort"},{default:o(()=>[s("div",null,[l(X,{modelValue:u.menuSort,"onUpdate:modelValue":e[12]||(e[12]=n=>u.menuSort=n)},null,8,["modelValue"]),ou])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{ru as _};
